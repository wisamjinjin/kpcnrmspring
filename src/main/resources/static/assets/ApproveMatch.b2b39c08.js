import{m as S,Q as _}from"./messageCommon.5db82364.js";import{r as p,q as P,o as H,a as u,d as r,w as o,b as s,ae as d,aj as L,f as C,e as c,Q as g,af as $,ah as U,ag as i}from"./index.c44c2320.js";import{Q as j,a as W}from"./QTable.50d33692.js";import{Q as G}from"./QForm.dd25b1b3.js";import{Q as D}from"./QPage.80b32476.js";import{a as K,Q as z}from"./QLayout.5a1e97d2.js";import{f as J,b as X,a as T,A as k}from"./sessionFunctions.3c5066a4.js";import{f as q}from"./formatTimeToLocal.04abce99.js";import"./QList.72d1a296.js";import"./QSelect.3898a8f6.js";import"./QItem.35fdbb09.js";import"./format.4f6c3584.js";import"./selection.54367025.js";import"./rtl.276c3f1b.js";import"./QResizeObserver.352c0735.js";const Z={class:"row"},fe={__name:"ApproveMatch",setup(ee){let w={};const V=J(["tableName","userContext","venueCd"]),b=p([]),t=p({matchNumber:"",venueCd:"",venueName:"",matchName:"",round:"",startTime:"",endTime:"",isBidAvailable:"",fileName:""}),v=p(!1),m=p(!1),f=p(!1),y=p(""),B=[{name:"match_no",label:"\uACBD\uAE30 \uBC88\uD638",align:"left",field:"match_no"},{name:"venue_name",label:"\uACBD\uAE30\uC7A5 \uC774\uB984",align:"left",field:"venue_name"},{name:"match_name",label:"\uACBD\uAE30\uBA85",align:"left",field:"match_name"},{name:"round",label:"\uB77C\uC6B4\uB4DC",align:"left",field:"round"},{name:"start_date",label:"\uC77C\uC790",align:"left",field:"start_date"},{name:"start_time",label:"\uC2DC\uC791",align:"left",field:"end_time"},{name:"end_time",label:"\uC885\uB8CC",align:"left",field:"end_time"},{name:"is_bid_available",label:"\uC785\uCC30 \uAC00\uB2A5 \uC5EC\uBD80",align:"left",field:e=>e.is_bid_available==="Y"?"\uC785\uCC30 \uAC00\uB2A5":"\uC785\uCC30 \uBD88\uAC00\uB2A5"},{name:"approved",label:"\uC2B9\uC778 \uC0C1\uD0DC",align:"left",field:"approved",field:e=>e.approved==="Y"?"\uC2B9\uC778":"\uBBF8\uC2B9\uC778"},{name:"actions",label:"\uCCA8\uBD80 \uBC0F \uC2B9\uC778",align:"center"}],N=P(()=>m.value?"\uC2B9\uC778 \uCDE8\uC18C\uD560 \uB0B4\uC6A9\uC774 \uB9DE\uC73C\uBA74 \uD655\uC778\uBC84\uD2BC\uC744 \uD074\uB9AD\uD558\uC138\uC694.":v.value?"\uC2B9\uC778\uD560 \uB0B4\uC6A9\uC774 \uB9DE\uC73C\uBA74 \uD655\uC778\uBC84\uD2BC\uC744 \uD074\uB9AD\uD558\uC138\uC694.":f.value?"\uC0C1\uC138\uC815\uBCF4\uC785\uB2C8\uB2E4.":""),A=async()=>{try{const e=await T.get(k.GET_ALLMATCHES,{params:{telno:w.telno,userType:w.userType,venueCd:V.venueCd}});e.status===200&&(b.value=e.data)}catch(e){x(e)}},E=e=>{if(e.approved==="Y"){alert("\uC774\uBBF8 \uC2B9\uC778\uB41C \uAC74\uC785\uB2C8\uB2E4.");return}v.value=!0,Q(e)},M=e=>{if(e.approved!=="Y"){alert("\uC544\uC9C1 \uC2B9\uC778\uC774 \uC548\uB41C \uAC74\uC785\uB2C8\uB2E4.");return}m.value=!0,Q(e)},Q=e=>{q(e.start_datetime),q(e.end_datetime),t.value={matchNumber:e.match_no,venueCd:e.venue_cd,venueName:e.venue_name,matchName:e.match_name,round:e.round,startDate:e.start_date?new Date(e.start_date).toISOString().slice(0,10):"",startTime:e.start_time?e.start_time.slice(0,5):"",endTime:e.end_time?e.end_time.slice(0,5):"",isBidAvailable:e.is_bid_available,fileName:e.filename_attached}},O=async()=>{try{let e=m.value?"N":"Y";const l={...t.value,telno:w.telno,userType:w.userType,actionType:e};(await T.post(k.APPROVE_MATCH,l)).status===200&&(y.value="\uC131\uACF5\uC801\uC73C\uB85C \uC791\uC5C5\uC774 \uC218\uD589\uB418\uC5C8\uC2B5\uB2C8\uB2E4.",A(),R())}catch(e){x(e)}},h=()=>{R()},Y=async e=>{if(!e){alert("\uCCA8\uBD80\uD654\uC77C\uC774 \uC5C6\uC2B5\uB2C8\uB2E4.");return}try{const l=await T.get(k.DOWNLOAD_MATCHINFO,{params:{fileName:e},responseType:"blob"}),a=window.URL.createObjectURL(new Blob([l.data])),n=document.createElement("a");n.href=a,n.setAttribute("download",e),document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(a)}catch(l){console.error(`\uD30C\uC77C \uB2E4\uC6B4\uB85C\uB4DC \uC624\uB958: ${l.message}`)}},F=()=>{navigate(router,V.userContext,"login")},I=()=>{emit("update-status",{isLoggedIn:!1,hasSelectedMatch:!1})},x=e=>{y.value=e.response?e.response.data:e.request?S.ERR_NETWORK:S.ERR_ETC},R=()=>{m.value=!1,v.value=!1,f.value=!1};return H(async()=>{(await X(V.userContext)).success||(I(),F()),await A()}),(e,l)=>(u(),r(D,{class:"common-container"},{default:o(()=>[s(z,{view:"lHh lpr lFf"},{default:o(()=>[l[15]||(l[15]=d("h6",null,"\uACBD\uAE30 \uC815\uBCF4",-1)),s(K,null,{default:o(()=>[s(D,{class:"q-pa-md"},{default:o(()=>[!b.value||b.value.length===0?(u(),r(L,{key:0},{default:o(()=>[l[9]||(l[9]=d("br",null,null,-1)),l[10]||(l[10]=d("br",null,null,-1)),l[11]||(l[11]=d("br",null,null,-1)),s(_,null,{default:o(()=>l[8]||(l[8]=[C("\uD604\uC7AC \uB300\uD68C \uC815\uBCF4\uAC00 \uC5C6\uC2B5\uB2C8\uB2E4.")])),_:1}),l[12]||(l[12]=d("br",null,null,-1)),l[13]||(l[13]=d("br",null,null,-1)),l[14]||(l[14]=d("br",null,null,-1))]),_:1})):c("",!0),b.value.length>0?(u(),r(j,{key:1,rows:b.value,columns:B,"row-key":"match_no",flat:"",dense:""},{"body-cell-actions":o(a=>[s(W,{props:a},{default:o(()=>[a.row.approved!=="Y"?(u(),r(g,{key:0,push:"",color:"white","text-color":"blue-grey-14",label:"\uC2B9\uC778",onClick:n=>E(a.row)},null,8,["onClick"])):c("",!0),a.row.approved==="Y"?(u(),r(g,{key:1,push:"",color:"white","text-color":"deep-orange-14",label:"\uCDE8\uC18C",onClick:n=>M(a.row)},null,8,["onClick"])):c("",!0),s(g,{push:"",color:"white","text-color":"blue-grey-14",label:"\uCCA8\uBD80 \uB2E4\uC6B4\uB85C\uB4DC",disable:!a.row.filename_attached,icon:"download",onClick:n=>Y(a.row.filename_attached)},null,8,["disable","onClick"])]),_:2},1032,["props"])]),_:1},8,["rows"])):c("",!0),v.value||m.value||f.value?(u(),r(L,{key:2,class:"q-mt-lg"},{default:o(()=>[s($,null,{default:o(()=>[N.value?(u(),r(_,{key:0,class:"q-mb-md"},{default:o(()=>[C(U(N.value),1)]),_:1})):c("",!0),s(G,{class:"q-gutter-md q-gutter-sm-md-up"},{default:o(()=>[s(i,{modelValue:t.value.matchNumber,"onUpdate:modelValue":l[0]||(l[0]=a=>t.value.matchNumber=a),label:"\uBC88\uD638",type:"number",disable:"",class:"col-xs-12 col-sm-6"},null,8,["modelValue"]),s(i,{modelValue:t.value.venueName,"onUpdate:modelValue":l[1]||(l[1]=a=>t.value.venueName=a),label:"\uACBD\uAE30\uC7A5",disable:"",class:"col-xs-12 col-sm-6"},null,8,["modelValue"]),s(i,{modelValue:t.value.matchName,"onUpdate:modelValue":l[2]||(l[2]=a=>t.value.matchName=a),label:"\uACBD\uAE30",disable:"",class:"col-xs-12 col-sm-6"},null,8,["modelValue"]),s(i,{modelValue:t.value.round,"onUpdate:modelValue":l[3]||(l[3]=a=>t.value.round=a),label:"\uB77C\uC6B4\uB4DC",disable:"",class:"col-xs-12 col-sm-6"},null,8,["modelValue"]),s(i,{modelValue:t.value.startDate,"onUpdate:modelValue":l[4]||(l[4]=a=>t.value.startDate=a),label:"\uACBD\uAE30 \uC77C\uC790",type:"date",disable:"",class:"col-12 col-md-6"},null,8,["modelValue"]),s(i,{modelValue:t.value.startTime,"onUpdate:modelValue":l[5]||(l[5]=a=>t.value.startTime=a),label:"\uC2DC\uC791 \uC2DC\uAC04",type:"time",disable:"",class:"col-12 col-md-6"},null,8,["modelValue"]),s(i,{modelValue:t.value.endTime,"onUpdate:modelValue":l[6]||(l[6]=a=>t.value.endTime=a),label:"\uC885\uB8CC \uC2DC\uAC04",type:"time",disable:"",class:"col-12 col-md-6"},null,8,["modelValue"]),s(i,{modelValue:t.value.isBidAvailable,"onUpdate:modelValue":l[7]||(l[7]=a=>t.value.isBidAvailable=a),label:"\uC785\uCC30 \uAC00\uB2A5 \uC5EC\uBD80",disable:"",class:"col-xs-12 col-sm-6"},null,8,["modelValue"])]),_:1}),d("div",Z,[s(g,{disable:!m.value&&!v.value&&!f.value,label:"\uD655\uC778",onClick:O,class:"q-mt-md col-xs-12 col-sm-6"},null,8,["disable"]),s(g,{disable:!m.value&&!v.value&&!f.value,push:"",color:"white","text-color":"deep-orange-14",label:"\uCDE8\uC18C",onClick:h,class:"q-mt-md col-xs-12 col-sm-6"},null,8,["disable"])])]),_:1})]),_:1})):c("",!0),y.value?(u(),r(_,{key:3,class:"q-mt-lg"},{default:o(()=>[C(U(y.value),1)]),_:1})):c("",!0)]),_:1})]),_:1})]),_:1})]),_:1}))}};export{fe as default};
